## Theme Mode 和 Background 颜色问题修复方案

### 问题分析

#### Theme Mode 切换问题：
1. TopBar 正确绑定了切换事件（第 142 行）
2. 但 `theme.mode` 只影响生成的 CSS 变量中的 `color-scheme`
3. **关键问题**：应用没有根据 `theme.mode` 动态应用 `dark` 类到 DOM
4. CSS 变量切换没有触发实际的视觉效果变化

#### Background 颜色问题：
1. CanvasBackground 和 PreviewCanvas 都正确引用了 `tokens.theme.palette.bg`
2. **潜在问题**：CanvasBackground 依赖 `effects.gradient.enabled` 决定是否显示 bg
3. 如果 gradient 启用，bg 颜色可能被 gradient 覆盖

### 修复方案

#### 1. 添加 ThemeModeObserver 组件
- 创建新组件监听 `theme.mode` 变化
- 动态在 `html` 元素上添加/移除 `dark` 类
- 触发 `color-scheme` 变化

#### 2. 修复 CanvasBackground 逻辑
- 确保 gradient 禁用时 bg 颜色正确显示
- 当 gradient 启用时也显示 bg 颜色（作为 fallback）
- 明确订阅 `version` 确保更新

### 修改文件
- `components/ThemeModeObserver.tsx`（新建）
- `app/layout.tsx`
- `components/preview/CanvasBackground.tsx`

### 预期效果
- **Theme Mode 切换**：点击太阳/月亮图标时，整个应用的主题实时切换（亮色/暗色模式）
- **Background 颜色**：选择 Palette → Background 颜色时，Canvas 背景实时变化